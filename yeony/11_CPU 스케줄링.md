# 11-1. CPU 스케줄링

- 정의는 운영체제가 프로세스들에게 공정하고 합리적으로 CPU 자원을 배분하는 것!

## 프로세스 우선순위

- 프로세스들의 우선순위는 어떻게 매겨지는 걸까?
  - 프로세스 과정에 대한 이해가 필요하다..!
- 대부분의 프로세스들은 CPU와 입출령장치를 모두 사용하여 실행되기 때문에 `실행 상태`와 `대기 상태`를 반복한다
- 둘 다 사용할지언정 CPU와 입출력장치 중 하나에 치중하여 더 많이 사용하는 프로세스가 있다
  - 입출력 집중 프로세스, I/O bound process
    - 비디오 재생, 디스크 백업같이 입출력장치를 많이 사용하는 프로세스
    - 실행보다는 대기 상태에 많이 머물 것이다
  - CPU 집중 프로세스, CPU bound process
    - 복잡한 수학 연산, 컴파일, 그래픽 작업 등 CPU를 많이 사용하는 프로세스
    - 대기보다는 실행 상태에 많이 머물 것이다
- `CPU 버스트` : CPU를 이용하는 작업을 일컫는 단어
- `입출력 버스트` : 입출력장치를 기다리는 작업을 일컫는 단어
- 입출력 집중 프로세스와 CPU 집중 프로세스가 동시에 CPU 사용을 요청하면 입출력 집중 프로세스에게 우선순위를 넘겨주고, 얼른 대기 상태로 넘겨버린 후 CPU 집중 프로세스가 CPU를 사용할 수 있도록 할당한다
- 이런 우선순위는 앞서 나왔던 PCB에 명시되어 있다

## 스케줄링 큐

- PCB의 우선순위가 있어도, 프로세스는 늘 유동적으로 움직이며 운영체제가 계속적으로 모든 프로세스의 PCB를 뒤져가며 우선순위가 높은 것을 찾아낼 수는 없다
- CPU 사용하고 싶은 프로세스는 줄을 서시오~ → 스케줄링 큐
- 운영체제는 스케줄링 큐를 가지고 CPU나 입출력장치를 사용할 수 있게끔 준비한다
- 큐의 종류
  - 준비 큐
    - CPU를 사용하고 싶은 프로세스
  - 대기 큐
    - 입출력장치를 이용하기 위해 대기 상태에 있는 프로세스
- 운영체제는 큐에서 우선순위가 높은 프로세스는 순서가 되지 않아도 즉시 CPU를 할당한다

## 선점형과 비선점형 스케줄링

- 만약, 프로세스가 CPU를 사용중일 때, 다른 프로세스가 급하다며 CPU 사용을 요청한다면 ?
  1. 현재 CPU를 사용중인 프로세스를 중단시키고, 급한 프로세스에게 CPU 사용을 허락한다
     1. `선점형 스케줄링` 이라 한다
     2. CPU 사용을 강제로 빼앗는다
     3. 문맥 교환이 자주 일어나는 단점이 있다
  2. 현재 CPU를 사용중인 프로세스의 대기나 종료상태를 기다리라고 한다
     1. `비선점형 스케줄링` 이라 한다
     2. 모든 프로세스가 골고루 CPU 사용을 할 수 없다
- 일반적으로 운영체제는 선점형 스케줄링 방식을 사용하고 있다

# 11-2. CPU 스케줄링 알고리즘

## 스케줄링 알고리즘의 종류

### 선입 선처리 스케줄링, FCFS 스케줄링(First Come First Served Scheduling)

- 준비 큐에 삽입된 순서대로 프로세스를 실행한다
- 비선점형 스케줄링
- 기다리는 시간으로 인해 비효율적인 작업 처리가 이어질 수 있다
  - 아주 적은 시간동안 실행할 것이데, 기다리는 시간이 더 길어져버리는 현상을 `호위 효과(convoy effect)`라고 한다

### 최단 작업 우선 스케줄링, SJF 스케줄링(Shortest Job First Scheduling)

- 준비 큐에 있는 프로세스들 중 가장 CPU 이용 시간이 짧은 프로세스부터 실행한다

### 라운드 로빈 스케줄링

- 선입 선처리 스케줄링에 타임 슬라이스 개념이 덧붙었다
- 타임 슬라이스?
  - 각 프로세스가 CPU를 사용할 수 있는 정해진 시간
- 각 정해진 시간만큼 CPU를 사용하고 순서를 넘긴다
  - 프로세스 상태와 상관없이 정해진 시간이 끝나면 큐의 맨 뒤로 가야한다
- 타임 슬라이스 크기가 너무 짧으면 문맥 교환이 너무 많이 일어나고, 너무 길면 호위 효과의 위험이 있다

### 최소 잔여 시간 우선 스케줄링, SRT 스케줄링(Shortest Remaining Time)

- CPU를 정해진 시간만큼 사용하되, 다음 프로세스는 CPU 사용 시간이 가장 짧은 프로세스이다

### 우선순위 스케줄링, priority scheduling

- 우선순위가 높은 프로세스부터 계속 실행되게 되면, 우선순위가 낮은 프로세스들은 자꾸 순서가 뒤로 밀려날 것이다..
  - 우선순위 높은 프로세스가 계속 준비 상태가 되면 큐 새치기를 할 것이기 때문..
  - 이런 현상을 기아 현상이라 한다
- 기아 현상을 막기 위해서 `에이징(aging)` 기법을 사용한다
  - 대기하는 프로세스들에게 우선순위를 조금 씩 높여주는 방식

### 다단계 큐 스케줄링, multilevel queue scheduling

- 우선순위 별로 큐를 여러개 사용하는 방식
- 여러 개의 큐를 돌리면 우선순위 구분이 쉬워진다
- 타임 슬라이스도 각 큐에 따라 다르게 설정할 수도 있다.. !

### 다단계 피드백 큐 스케줄링, multilevel feedback queue scheduling

- 큐를 여러개 사용하면 우선순위 스케줄링 응용하여 사용할 수 없다
  - 프로세스가 우선순위에 따라 나눠진 큐를 자유롭게 움직일 수 없기 때문..!
- 여기서는 우선순위 큐를 프로세스들이 이동할 수 있다..!
- 타임 슬라이스 동안 실행되고, 시간을 다쓰면 우선순위가 내려가고, 에이징 기법을 이용해 오래 기다린 프로세스는 우선순위가 올라가는 방식으로…
- 구현은 복잡하나 가장 일반적인 CPU 스케줄링 알고리즘이다

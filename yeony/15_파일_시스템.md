# 15-1. 파일과 디렉터리

## 파일, file

- 우리는 컴퓨터를 파일 단위로 이용한다
- 파일은 보조기억장치에 저장된 정보의 집합이다, 의미 있고 관련 있는 정보를 모은 논리적 단위이다
- 파일이 가진 정보는 아래 두 가지가 있다
  - 속성, attribute
  - 메타데이터, metadata

**파일 속성과 유형**
속성의 종류는..?
유형 - 파일 종류, 크기 - 파일의 현재 크기와 허용 가능한 최대 크기, 보호 - 수정 권한, 생성 날짜, 마지막 접근 날짜, 마지막 수정 날짜, 생성자, 소유자, 위치
파일의 유형은 `확장자`를 통해 나타낸다

**파일 연산을 위한 시스템 호출**
운영체제는 파일을 다루기 위해 파일 연산을 위한 시스템 호출을 제공한다
파일 생성, 삭제, 열기, 닫기, 읽기, 쓰기

## 디렉터리, directory

- 파일들을 관리하기 위해 디렉터리가 있지.. = folder
- 원래는 1단계 디렉터리 구조만 있었다 - 1depth
- 점점 파일이 많아지면서 `트리 구조 디렉터리`가 생겼다
  - 최상위가 root 디렉터리
- 이런 트리 구조에서 `경로` 가 생긴 것이다

**절대 경로와 상대 경로**
절대 경로: root에서 시작된 고유한 경로
상대 경로: 현재 디렉터리에서 시작하는 경로

**디렉터리 연산을 위한 시스템 호출**
디렉터리 생성, 삭제, 열기, 닫기, 읽기

**디렉터리 엔트리**
사실상 디렉터리도 하나의 파일이다
디렉터리는 파일과 비슷하지만 내용물은 좀 다른데.. 해당 디렉터리에 담긴 대상과 관련된 정보를 테이블 형태로 가지고 있다 → 요 형태대로 보조 기억 장치에 저장된다
디렉터리의 엔트리만 보아도 디렉터리에 무엇이 들어있는지 보조기억장치의 어디에 있는지 알 수 있다
파일 시스템에 따라 담기는 정보의 차이가 있다

# 15-2. 파일 시스템

- 파일과 디렉터리를 보조기억장치에 어떻게 할당하고, 접근하는지..

## 파티셔닝과 포매팅

- 새 보조기억장치를 사용할 때는 파티션을 나누고(`파티셔닝`), 포맷 작업(`포매팅`)을 해야한다

**파티셔닝, partitioning**
저장 장치의 논리적인 구역을 분리한다
보조기억장치는 하나의 파티션일 수도 있고, 여러개의 파티션으로 구성될 수도 있다

**포매팅, formatting**
저장 장치를 초기화하는 뜻은 아니다
파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지 결정하고, 새로운 데이터를 쓸 준비를 하는 작업이다

- 파티션마다 다른 파일 시스템을 사용할 수도 있다

## 파일 할당 방법

- 운영체제는 파일과 디렉터리를 `블록(block)`단위로 읽고 쓴다
- 블록의 번호는 식별자이다
- 크기가 작으면 적은 수의 블록을 차지하고, 크기가 크면 많은 수의 블록을 차지한다
- 할당 방법에는 연속 할당과 불연속 할당이 존재한다

**연속 할당, contiguous allocation**
블록에 연속적으로 파일을 할당하는 것
첫번째 블록 주소와 길이, 파일 이름을 명시한다
이는 외부 단편화의 문제를 야기한다 (메모리에서도 나왔다..!)

**연결 할당, linked allocation**
연결리스트 자료구조의 원리군요..!
다음 블록 주소를 함께 기억하는 것이다
연결리스트의 단점과 동일하게 중간에 있는 파일부터 찾기 힘들다(첫번째부터 찾아서 순서대로 찾아야한다)
하드웨어 고장이나 오류로 인해 블록 하나가 고장나면 그 이후 블록은 찾을 수 없다..
그래서 요즘은 연결 할당을 변형하여 FAT 파일 시스템을 사용하고 있다..

**색인 할당, indexed allocation**
색인 블록으로 모아 관리한다
색인 블록을 구성하는 데이터 블록 주소만 있으면 관련된 파일 데이터에 모두 접근이 가능하다
디렉터리 엔트리에 색인 블록 주소를 명시한다

## 파일 시스템 살펴보기

### FAT 파일 시스템, File Allocation Table

- 연결 할당의 단점을 보완한 파일 시스템이다
- 각 블록에 포함된 다음 블록의 주소들을 모아서 테이블을 다시 만들어 관리한다
  - 옛날 MS-DOS에서 많이 사용되었고, USB, SD 카드에서도 많이 활용된다
  - 윈도우에서는 블록말고 클러스터라는 용어를 사용..
- 파티션의 앞부분에 만들어진다
- FAT은 캐시될 수 있기 때문에 메모리에 적재되면 속도가 더 빨라진다

### 유닉스 파일 시스템

- 색인 할당 기반의 파일 시스템
- 색인 블록 = `i-node(index-node)`
- 15개의 블록 주소가 저장될 수 있다
- 파일 속성 정보는 i-node에 표현된다
- i-node는 15개의 유한정한 크기이기 때문에 파일의 데이터 블록을 모두 가리키지 못할 수 있다
- 해결 방법

1. 블록 주소 중 열두 개에는 직접 블록 주소를 저장한다
   직접 블록 : 파일 데이터가 저장된 블록 (바로 가리킬 수 있게)

2. 1번으로 충분하지 않다면 열세 번째 주소에 단일 간접 블록 주소를 저장한다
   직접 블록과 다르게 블록 주소를 저장한 블록이다

3. 2번이 충분하지 않다면 열네 번째 주소에 이중 간접 블록 주소를 저장한다
   단일 간접 블록들의 주소를 저장하는 블록

4. 3번이 충분하지 않다면 열다섯 번째 주소에 삼중 간접 블록 주소를 저장한다
   이중 간접 블록주소들의 주소를 저장하는 블록

- 삼중까지 하면 거의 웬만한 크기의 파일들은 저장이 가능하다
